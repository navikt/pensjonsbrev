#Used for local testing purposes
services:
  pdf-bygger:
    build: ./pdf-bygger
    ports:
      - "8081:8080"
  pensjon-brevbaker:
    environment:
      - PDF_BUILDER_URL=http://pdf-bygger:8080
      - JWT_JWKS_URL_STS=http://localhost:8060/rest/isso/oauth2/connect/jwk_uri
      - JWT_ISSUER_STS=http://vtp-pensjon:8060
      - JWT_AUDIENCE_STS=brevbaker-123
      - JWT_JWKS_URL_AZURE_AD=http://localhost:8060/rest/isso/oauth2/connect/jwk_uri
      - JWT_ISSUER_AZURE_AD=https://login.microsoftonline.com/966ac572-f5b7-4bbe-aa88-c76419c0f851/v2.0
      - JWT_AUDIENCE_AZURE_AD=brevbaker-123
      - JAVA_OPTS=-Dio.ktor.development=true
    build: ./pensjon-brevbaker
    ports:
      - "8080:8080"
  master:
    profiles:
      - locust
    image: locustio/locust
    ports:
      - "8089:8089"
    volumes:
      - ./:/mnt/locust
    command: -f /mnt/locust/locustfile.py --master -H http://master:8089

  worker:
    profiles:
      - locust
    image: locustio/locust
    volumes:
      - ./:/mnt/locust
    command: -f /mnt/locust/locustfile.py --worker --master-host master