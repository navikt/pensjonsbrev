name: "Build and publish new LaTeX image"
on:
  workflow_dispatch:
  pull_request:
env:
  "IMAGE_LATEX": "ghcr.io/${{ github.repository }}/pensjon-latex:$(date +'%Y-%m-%d-%H:%M')"
jobs:
  "build-container":
    name: "build latest texlive/XeTeX version from ctan"
    runs-on: "ubuntu-latest"
    steps:
      - uses: "actions/checkout@v2"
      - name: Build and publish Docker image
        run: "docker build --pull --tag ${IMAGE_LATEX} -f pdf-bygger/latex.Dockerfile pdf-bygger && echo $GITHUB_TOKEN | docker login\
        \ --username $GITHUB_REPOSITORY --password-stdin https://ghcr.io\
        \ && docker push ${IMAGE_LATEX}"
        env:
          "GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}"