name: Template model generator
on:
  workflow_dispatch:
  pull_request:
    paths:
      - "build.gradle.kts"
      - "gradle.properties"
      - "gradle/libs.versions.toml"
      - "template-model-generator/**"
      - ".github/workflows/template-model-generator.yml"
env:
  JavaDistribution: "temurin"
  JavaVersion: 21
jobs:
  build-template-model-generator:
    name: "Build Template Model Generator"
    runs-on: "ubuntu-latest"
    permissions:
      contents: "read"
      packages: "read"
      id-token: "write"
    steps:
      - uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683
        with:
          persist-credentials: false
      - uses: gradle/actions/wrapper-validation@94baf225fe0a508e581a564467443d0e2379123b
      - uses: gradle/actions/setup-gradle@94baf225fe0a508e581a564467443d0e2379123b
      - uses: actions/setup-java@3a4f6e1af504cf6a31855fa899c6aa5355ba6c12
        with:
          "distribution": ${{ env.JavaDistribution }}
          "java-version": ${{ env.JavaVersion }}
      - name: "compile and run tests"
        run: |
          ./gradlew :brevbaker-api-model-common:publishToMavenLocal
          ./gradlew :template-model-generator:build
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
